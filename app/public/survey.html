<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Home</title>

  <!--Jquery-->
  <script src="https://code.jquery.com/jquery.js"></script>
  <!-- Latest compiled and minified CSS, Bootstrap 4.0 -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>

</head>
<body>
  <div class="container">
    <h1>Survey Questions</h1>
    <br>
    <h2>About You</h2>
    <form>
      Name (required)<br>
      <input id = "name" type="text" name="firstname"><br>
      Link to Photo Image (required)<br>
      <input id = "photo" type="text" name="lastname">
    </form>
    <br>

    <h2>Question 1</h2>
    <h4>I find myself daydreaming often.</h4>
    <select data-placeholder="" class="chosen-select" id="q1">
    <option value=""></option>
      <option value="1">1 (Strongly Disagree)</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5 (Strongly Agree)</option>
    </select>
    <br>
    <br>
    <h2>Question 2</h2>
    <h4>I am a picky eater.</h4>
    <select data-placeholder="" class="chosen-select" id="q2">
    <option value=""></option>
      <option value="1">1 (Strongly Disagree)</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5 (Strongly Agree)</option>
    </select>
    <br>
    <br>
    <h2>Question 3</h2>
    <h4>I enjoy alcoholic beverages.</h4>
    <select data-placeholder="" class="chosen-select" id="q3">
    <option value=""></option>
      <option value="1">1 (Strongly Disagree)</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5 (Strongly Agree)</option>
    </select>
    <br>
    <br>
    <h2>Question 4</h2>
    <h4>I like sports.</h4>
    <select data-placeholder="" class="chosen-select" id="q4">
    <option value=""></option>
      <option value="1">1 (Strongly Disagree)</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5 (Strongly Agree)</option>
    </select>
    <br>
    <br>
    <h2>Question 5</h2>
    <h4>I like movies.</h4>
    <select data-placeholder="" class="chosen-select" id="q5">
    <option value=""></option>
      <option value="1">1 (Strongly Disagree)</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5 (Strongly Agree)</option>
    </select>
    <br>
    <br>
    <h2>Question 6</h2>
    <h4>I like shopping.</h4>
    <select data-placeholder="" class="chosen-select" id="q6">
    <option value=""></option>
      <option value="1">1 (Strongly Disagree)</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5 (Strongly Agree)</option>
    </select>
    <br>
    <br>
    <h2>Question 7</h2>
    <h4>I enjoy hanging out with large groups of people.</h4>
    <select data-placeholder="" class="chosen-select" id="q7">
    <option value=""></option>
      <option value="1">1 (Strongly Disagree)</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5 (Strongly Agree)</option>
    </select>
    <br>
    <br>
    <h2>Question 8</h2>
    <h4>I like to sing.</h4>
    <select data-placeholder="" class="chosen-select" id="q8">
    <option value=""></option>
      <option value="1">1 (Strongly Disagree)</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5 (Strongly Agree)</option>
    </select>
    <br>
    <br>
    <h2>Question 9</h2>
    <h4>I like video games.</h4>
    <select data-placeholder="" class="chosen-select" id="q9">
    <option value=""></option>
      <option value="1">1 (Strongly Disagree)</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5 (Strongly Agree)</option>
    </select>
    <br>
    <br>
    <h2>Question 10</h2>
    <h4>I like the outdoors.</h4>
    <select data-placeholder="" class="chosen-select" id="q10">
    <option value=""></option>
      <option value="1">1 (Strongly Disagree)</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5 (Strongly Agree)</option>
    </select>
    <br>
    <br>

    <button id = 'submit'>Submit</button>

    <!--Modal!-->
    <div class="container">
      <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog">      
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h4 class="modal-title">Your Best Friend Match</h4>
            </div>
            <div class="modal-body">
              <p id = "modal-text">Some text in the modal.</p>
              <img id = "modal-img" src="http://www.sepeb.com/random-picture/random-picture-013.jpg" height="100" width="100">
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
          </div>    
        </div>
      </div>  
    </div>
    <br>
    <footer class="footer">
      <div class="container">
        <p><a href="#" id="clear">Reset Friends</a> | <a href="/api/friends">API Friends List</a> | <a href="https://github.com/deevine">GitHub Repo</a></p>
      </div>
    </footer>
  </div>
</body>

<script>

  $('#submit').on('click', function(event) {
    event.preventDefault();
    var isTrue = true; //will use this for data validation
    var scoreArray = [];
    scoreArray.push($('#q1').val());
    scoreArray.push($('#q2').val());
    scoreArray.push($('#q3').val());
    scoreArray.push($('#q4').val());
    scoreArray.push($('#q5').val());
    scoreArray.push($('#q6').val());
    scoreArray.push($('#q7').val());
    scoreArray.push($('#q8').val());
    scoreArray.push($('#q9').val());
    scoreArray.push($('#q10').val());

    //check that every question has been filled out
    for (var i = 0; i < scoreArray.length; i++) {
      if (scoreArray[i] === ''){
        // console.log('nothing at this position' + i)
        isTrue = false;
      }
      else{
        // console.log('yay, there\'s a value!' + scoreArray[i]);
        isTrue = true;
      }
    }

    var newSurvey = {
     name: $('#name').val(),
     photoUrl: $('#photo').val(),
     scores: scoreArray,
    };
    console.log(newSurvey);

    if(isTrue){
       $.post("/api/friends", newSurvey,
      function(data) {
        // If a table is available... tell user they are booked.
        if (data) {
          alert("Yay! Server returned result!");
          $('#myModal').modal('show');
          console.log(data);
          $('#modal-text').text(data.name);
          $('#modal-img').attr('src', data.photoUrl);
        }
      });
    }
    else {
      console.log('please fill out all survey fields');
    }
   

      // This function resets all of the data in our tables. This is intended to let you restart a demo.
      function clearFriends() {
        var currentURL = window.location.origin;
        $.ajax({ url: currentURL + "/api/clear", method: "POST" });
      }

      $("#clear").on("click", function() {
        alert("Reseting to default friends list...");
        clearFriends();

        // Refresh the page after data is cleared
        location.reload();

      });

  });

</script>

</html>
